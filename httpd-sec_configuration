-----------------------------------------------------------------------
#######    Vulnerability Tutorial - Apache ETag vulnerability ########
-----------------------------------------------------------------------		
 	
 	Created: 10/02/09	 	 	(BROWN light)	 
	Impact	
A remote attacker could determine inode numbers on the server.	
	Background	
Apache is a web server which runs on Unix, Linux, Mac OS and Windows systems.
Apache supports the ETag (Entity Tag) HTTP header, which is typically a function of the file attributes of the requested web page. The ETag is used to determine whether cached content has changed.

An inode is a data structure on a Unix or Linux file system that stores basic information about a file, such as the size, modification date, and owner. Each inode is identified by an inode number.

	The Problem	
CVE 2003-1418
The ETag header generated by Apache web servers allows the client to determine the inode number of the requested file. This could provide an attacker with information which could help launch further attacks.	
	Resolution	
Use the FileETag directive to remove the INode component from the calculation of the ETag. For example, place the following line in the Apache configuration file to calculate the ETag based only on the file's modification time and size:
FileETag None

By removing the ETag header, you disable caches and browsers from being able to validate files, so they are forced to rely on your Cache-Control and Expires header. Basically you can remove If-Modified-Since and If-None-Match requests and their 304 Not Modified Responses.
Entity tags (ETags) are a mechanism to check for a newer version of a cached file. 
Please don't turn off ETags and Last-Modified headers for your .html files, leave one of them ON. (I use Last-Modified for .html).

